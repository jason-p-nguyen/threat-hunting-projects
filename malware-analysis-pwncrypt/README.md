# 🧾 Malware Analysis Report: PwnCrypt Ransomware Simulation

---

## 📄 1. Executive Summary

**Sample Name:** `pwncrypt.ps1`  
**Type:** Simulated Ransomware (Educational)  
**Execution Date:** 2025-08-04  
**Analyst:** Jason Nguyen  
**Purpose:** This is a controlled simulation of ransomware behavior using the `PwnCrypt.ps1` script created by Josh Madakor. The analysis was conducted in an isolated Windows 10 VM onboarded to Microsoft Defender for Endpoint (MDE). The goal was to understand how ransomware operates and learn how to analyze file, log, and network artifacts.

---

## 🧬 2. Malware Sample Details

| Field         | Value                                                                 |
|---------------|-----------------------------------------------------------------------|
| Filename      | `pwncrypt.ps1`                                                        |
| SHA-256       | `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8`    |
| File Path     | `C:\ProgramData\pwncrypt.ps1`                                         |
| File Type     | PowerShell script (`.ps1`)                                            |
| Source        | [GitHub - Josh Madakor Public Repo](https://github.com/joshmadakor1/lognpacific-public/blob/main/cyber-range/entropy-gorilla/pwncrypt.ps1) |
| File Size     | *(To be filled)*                                                      |
| First Seen    | *(To be filled if submitted to VT or Hybrid Analysis)*               |

---

## 🔍 3. Static Analysis Summary

- **Hash Check:**
  - SHA256: `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8`
- **VirusTotal Result:** No detection (0/70), file considered benign.
- **Strings:** *(Attempted `strings` extraction, encountered error)*
- **PEStudio:**
  - PEStudio ran successfully (screenshots captured).
  - *No anomalies noted due to being a PowerShell script*.

---

## 🚀 4. Dynamic Analysis Summary

### 🖥️ Execution Environment
- **Host:** Windows 10 VM (`j-win10-cve`)
- **Monitoring Tools:** MDE, Event Viewer, PowerShell logs, file system access

### 📂 File System Activity
- Encrypted dummy files detected (screenshot taken)
- Ransom note `README.txt` dropped (screenshot taken)
- Script stored at `C:\ProgramData\pwncrypt.ps1` (screenshot taken)

### 🧾 Windows Logs (Event Viewer)
- **Security Logs (4688):**
  - No clear matches outside standard boot processes
  - Screenshot captured
- **PowerShell Operational Logs:**
  - Execution of `pwncrypt.ps1` found at 2025-08-04 06:29:36
  - 8 total logs captured (screenshots saved)
  - Final event at 2025-08-04 06:29:37
- **ScriptBlock Logging:** Not available (PowerShell Operational Logs were disabled)

---

## 📡 5. MDE-Based Artifact Collection (KQL + Logs)

### 🔍 File Events (`DeviceFileEvents`)
```kql
DeviceFileEvents
| where DeviceName == "j-win10-cve"
| where InitiatingProcessAccountName == "jnguyen.admin"
| where Timestamp between (datetime(2025-08-04T06:29:35.8265017Z) .. datetime(2025-08-04T06:29:37.3271798Z))
| project Timestamp, DeviceName, Account = InitiatingProcessAccountName, ActionType, FileName, FolderPath, InitiatingProcessCommandLine, SHA256
| order by Timestamp asc
````

* **Status:** Query executed, logs exported, and screenshot captured.

### ⚙️ Process Events (`DeviceProcessEvents`)

```kql
DeviceProcessEvents
| where DeviceName == "j-win10-cve"
| where AccountName == "jnguyen.admin"
| where Timestamp between (datetime(2025-08-04T06:29:35.8265017Z) .. datetime(2025-08-04T06:29:37.3271798Z))
| project Timestamp, DeviceName, AccountName, ActionType, FileName, FolderPath, ProcessCommandLine, SHA256, InitiatingProcessCommandLine
| order by Timestamp asc
```

* **Status:** Logs and screenshots captured, CSV export completed.

### 🌐 Network Events (`DeviceNetworkEvents`)

```kql
DeviceNetworkEvents
| where DeviceName == "j-win10-cve"
| where InitiatingProcessAccountName == "jnguyen.admin"
| where RemoteIP == "185.199.111.133"
| project Timestamp, DeviceName, AccountName = InitiatingProcessAccountName, ActionType, RemoteIP, RemotePort, RemoteUrl, InitiatingProcessCommandLine, InitiatingProcessSHA256
| order by Timestamp asc
```

* **Status:** Logs and screenshots captured for suspicious outbound IP connection.

---

## 🧪 6. Behavioral Analysis (To Be Completed)

> This section is reserved for reverse engineering or manual code analysis.
> You may include:

* Encryption method (if observed)
* Obfuscation or anti-analysis checks
* File overwrite behavior
* Runtime analysis of command-line execution

---

## 🧠 7. Indicators of Compromise (IOCs)

### 🔗 Hashes

| Type    | Value                                                              |
| ------- | ------------------------------------------------------------------ |
| SHA-256 | `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8` |

### 🗂 File Artifacts

* `C:\ProgramData\pwncrypt.ps1`
* `C:\Users\Public\README.txt` *(ransom note)*

### 🌐 Network IOCs

| Type | Value             |
| ---- | ----------------- |
| IP   | `185.199.111.133` |

---

## 🛡️ 8. Mitigation & Detection Recommendations

* Block outbound access to `185.199.111.133` in firewall/DNS
* Review PowerShell execution policies and logging settings
* Enable ScriptBlock logging for deeper audit visibility
* Consider adding SHA256 to EDR or AV blocklists
* Restore any modified or encrypted files from backup

---

## 🧩 9. MITRE ATT\&CK Mapping

| Technique | Description                        | ID               |
| --------- | ---------------------------------- | ---------------- |
| T1059.001 | PowerShell execution               | Execution        |
| T1047     | Windows Management Instrumentation | Execution        |
| T1027     | Obfuscated Files or Information    | Defense Evasion  |
| T1055     | Process Injection (if observed)    | *(To be filled)* |

---

## 📎 10. Appendix

* 📸 Screenshots of PEStudio, file artifacts, ransom note
* 📁 Exported logs from MDE
* 🔗 VirusTotal link: [VT scan](https://www.virustotal.com/gui/file/739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8)
* 📝 Event Viewer screenshots
* *(Add any external references or tools used)*

---

*End of Report*


