# ğŸ§¾ Malware Analysis Report: PwnCrypt Ransomware Simulation

---

## ğŸ“„ 1. Executive Summary

**Sample Name:** `pwncrypt.ps1`  
**Type:** Simulated Ransomware (Educational)  
**Execution Date:** 2025-08-04  
**Analyst:** Jason Nguyen  
**Purpose:** This is a controlled simulation of ransomware behavior using the `PwnCrypt.ps1` script created by Josh Madakor. The analysis was conducted in an isolated Windows 10 VM onboarded to Microsoft Defender for Endpoint (MDE). The goal was to understand how ransomware operates and learn how to analyze file, log, and network artifacts.

![screenshot](screenshots/1-pwncrypt.png)

---

## ğŸ§¬ 2. Malware Sample Details

| Field         | Value                                                                 |
|---------------|-----------------------------------------------------------------------|
| Filename      | `pwncrypt.ps1`                                                        |
| SHA-256       | `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8`    |
| File Path     | `C:\ProgramData\pwncrypt.ps1`                                         |
| File Type     | PowerShell script (`.ps1`)                                            |
| Source        | [GitHub - Josh Madakor Public Repo](https://github.com/joshmadakor1/lognpacific-public/blob/main/cyber-range/entropy-gorilla/pwncrypt.ps1) |
| File Size     | 6.29 KB                                                      |
| First Seen    | 31 July 2025 (VirusTotal)               |

---

## ğŸ” 3. Static Analysis Summary

- **Hash Check:**
  - SHA256: `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8`
![screenshot](screenshots/2-hash.png)

- **Strings:** *(Attempted `strings` extraction, encountered error)*

- **VirusTotal Result:** No detection (0/70), file considered benign.
![screenshot](screenshots/3-virustotal1.png)
![screenshot](screenshots/4-virustotal2.png)
![screenshot](screenshots/5-virustotal3.png)

- **PEStudio:**
  - PEStudio ran successfully (screenshots captured).
  - *No anomalies noted due to being a PowerShell script*.
![screenshot](screenshots/6-pestudio1.png)
![screenshot](screenshots/7-pestudio2.png)
![screenshot](screenshots/8-pestudio3.png)
![screenshot](screenshots/9-pestudio4.png)
![screenshot](screenshots/10-pestudio5.png)

---

## ğŸš€ 4. Dynamic Analysis Summary

### ğŸ–¥ï¸ Execution Environment
- **Host:** Windows 10 VM (`j-win10-cve`)
- **Monitoring Tools:** MDE, Event Viewer, PowerShell logs, file system access

### ğŸ“‚ File System Activity
- Encrypted dummy files detected 
![screenshot](screenshots/11-encryptedfiles.png)

- Ransom note `README.txt` dropped (screenshot taken)
![screenshot](screenshots/12-ransomnote.png)

- Script stored at `C:\ProgramData\pwncrypt.ps1` (screenshot taken)
![screenshot](screenshots/13-filelocation.png)
![screenshot](screenshots/14-pwncryptcontents.png)

### ğŸ§¾ Windows Logs (Event Viewer)
- **Security Logs (4688):**
  - No clear matches outside standard boot processes
![screenshot](screenshots/15-securitylogs.png)

- **PowerShell Operational Logs:**
  - Execution of `pwncrypt.ps1` found at 2025-08-04 06:29:36
![screenshot](screenshots/16-pwncryptstart.png)

  - 8 total logs captured (screenshots saved)
![screenshot](screenshots/17-logtotal.png)

  - Final event at 2025-08-04 06:29:37
 ![screenshot](screenshots/18-pwncryptstop.png)

- **ScriptBlock Logging:** Not available (PowerShell Operational Logs were disabled)

---

## ğŸ“¡ 5. MDE-Based Artifact Collection (KQL + Logs)

### ğŸ” File Events (`DeviceFileEvents`)
```kql
DeviceFileEvents
| where DeviceName == "j-win10-cve"
| where InitiatingProcessAccountName == "jnguyen.admin"
| where Timestamp between (datetime(2025-08-04T06:29:35.8265017Z) .. datetime(2025-08-04T06:29:37.3271798Z))
| project Timestamp, DeviceName, Account = InitiatingProcessAccountName, ActionType, FileName, FolderPath, InitiatingProcessCommandLine, SHA256
| order by Timestamp asc
````

* **Status:** Query executed, logs exported, and screenshot captured.

[See DeviceFileEvents CSV here](logs/devicefileevents.csv)

![screenshot](screenshots/19-devicefileevents.png)

### âš™ï¸ Process Events (`DeviceProcessEvents`)

```kql
DeviceProcessEvents
| where DeviceName == "j-win10-cve"
| where AccountName == "jnguyen.admin"
| where Timestamp between (datetime(2025-08-04T06:29:35.8265017Z) .. datetime(2025-08-04T06:29:37.3271798Z))
| project Timestamp, DeviceName, AccountName, ActionType, FileName, FolderPath, ProcessCommandLine, SHA256, InitiatingProcessCommandLine
| order by Timestamp asc
```

* **Status:** Logs and screenshots captured, CSV export completed.

[See DeviceProcessEvents CSV here](logs/deviceprocessevents.csv)

![screenshot](screenshots/20-deviceprocessevents.png)


### ğŸŒ Network Events (`DeviceNetworkEvents`)

```kql
DeviceNetworkEvents
| where DeviceName == "j-win10-cve"
| where InitiatingProcessAccountName == "jnguyen.admin"
| where RemoteIP == "185.199.111.133"
| project Timestamp, DeviceName, AccountName = InitiatingProcessAccountName, ActionType, RemoteIP, RemotePort, RemoteUrl, InitiatingProcessCommandLine, InitiatingProcessSHA256
| order by Timestamp asc
```

* **Status:** Logs and screenshots captured for suspicious outbound IP connection.

[See DeviceNetworkEvents CSV here](logs/devicenetworkevents.csv)

![screenshot](screenshots/21-devicenetworkevents.png)

---

## ğŸ§ª 6. Behavioral Analysis (To Be Completed)

> This section is reserved for reverse engineering or manual code analysis.
> You may include:

* Encryption method (if observed)
* Obfuscation or anti-analysis checks
* File overwrite behavior
* Runtime analysis of command-line execution

---

## ğŸ§  7. Indicators of Compromise (IOCs)

### ğŸ”— Hashes

| Type    | Value                                                              |
| ------- | ------------------------------------------------------------------ |
| SHA-256 | `739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8` |

### ğŸ—‚ File Artifacts

* `C:\ProgramData\pwncrypt.ps1`
* `C:\Users\Public\README.txt` *(ransom note)*

### ğŸŒ Network IOCs

| Type | Value             |
| ---- | ----------------- |
| IP   | `185.199.111.133` |

---

## ğŸ›¡ï¸ 8. Mitigation & Detection Recommendations

* Block outbound access to `185.199.111.133` in firewall/DNS
* Review PowerShell execution policies and logging settings
* Enable ScriptBlock logging for deeper audit visibility
* Consider adding SHA256 to EDR or AV blocklists
* Restore any modified or encrypted files from backup

---

## ğŸ§© 9. MITRE ATT\&CK Mapping

| Technique | Description                        | ID               |
| --------- | ---------------------------------- | ---------------- |
| T1059.001 | PowerShell execution               | Execution        |
| T1047     | Windows Management Instrumentation | Execution        |
| T1027     | Obfuscated Files or Information    | Defense Evasion  |
| T1055     | Process Injection (if observed)    | *(To be filled)* |

---

## ğŸ“ 10. Appendix

* ğŸ“¸ Screenshots of PEStudio, file artifacts, ransom note
* ğŸ“ Exported logs from MDE
* ğŸ”— VirusTotal link: [VT scan](https://www.virustotal.com/gui/file/739D9923E2DDF467CE9F997C82D36BFB72ACCC90ACC40573EAA5E1ABB2097CD8)
* ğŸ“ Event Viewer screenshots
* *(Add any external references or tools used)*

---

*End of Report*


